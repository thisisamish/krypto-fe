<p-sidebar
  position="right"
  [modal]="true"
  [visible]="cart.drawerOpen()"
  (onHide)="cart.closeDrawer()"
  styleClass="w-[24rem] max-w-[90vw]"
>
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-bold">Your Cart</h2>
    <button
      pButton
      type="button"
      icon="pi pi-times"
      (click)="cart.closeDrawer()"
      class="p-button-text"
    ></button>
  </div>

  <div *ngIf="cart.entries().length === 0" class="text-gray-600">
    Your cart is empty.
  </div>

  <div class="flex flex-col gap-4" *ngIf="cart.entries().length > 0">
    <div *ngFor="let e of cart.entries()" class="flex gap-3 items-center">
      <div
        class="h-16 w-16 rounded-lg overflow-hidden border border-gray-200 shrink-0"
      >
        <img
          [src]="e.item.imageUrl"
          alt=""
          class="object-cover w-full h-full"
        />
      </div>

      <div class="flex-1 min-w-0">
        <div class="font-semibold truncate">{{ e.item.name }}</div>
        <div class="text-xs text-gray-600">{{ e.item.size }}</div>
        <div class="text-sm font-semibold mt-0.5">
          ₹ {{ e.lineTotal | number : "1.0-0" }}
        </div>

        <div class="mt-2">
          <app-qty-stepper
            [value]="e.qty"
            (valueChange)="cart.setQuantity(e.id, $event, e.item)"
            [min]="0"
            size="sm"
          ></app-qty-stepper>
        </div>
      </div>
    </div>

    <div class="border-t border-gray-200 pt-4 mt-2">
      <div class="flex justify-between text-sm">
        <span class="text-gray-600">Items</span>
        <span class="font-medium">{{ cart.totalCount() }}</span>
      </div>
      <div class="flex justify-between text-base mt-2">
        <span class="font-semibold">Subtotal</span>
        <span class="font-bold"
          >₹ {{ cart.subtotal() | number : "1.0-0" }}</span
        >
      </div>

      <div class="flex gap-2 mt-4">
        <button
          pButton
          label="Clear"
          class="p-button-text"
          (click)="cart.clear()"
        ></button>
        <button pButton label="Checkout" class="flex-1"></button>
      </div>
    </div>
  </div>
</p-sidebar>
